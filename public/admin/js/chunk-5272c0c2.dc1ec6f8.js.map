{"version":3,"sources":["webpack:///./src/components/SystemMedia/Category.vue?1c96","webpack:///./src/components/LzPopconfirm.vue?b9ee","webpack:///src/components/LzPopconfirm.vue","webpack:///./src/components/LzPopconfirm.vue?39d7","webpack:///./src/components/LzPopconfirm.vue","webpack:///./src/components/FilePreview.vue?6ed0","webpack:///src/components/FilePreview.vue","webpack:///./src/components/FilePreview.vue?ebb4","webpack:///./src/components/FilePreview.vue","webpack:///./node_modules/lodash/_baseDifference.js","webpack:///./src/components/PageContent.vue?4ed1","webpack:///src/components/PageContent.vue","webpack:///./src/components/PageContent.vue?aa81","webpack:///./src/components/PageContent.vue","webpack:///./node_modules/@babel/runtime/helpers/esm/typeof.js","webpack:///./src/components/FilePreview.vue?0a39","webpack:///./src/components/PageContent.vue?2e79","webpack:///./src/components/LzPagination.vue?5fe9","webpack:///./src/components/SystemMedia/index.vue?772a","webpack:///./src/components/SystemMedia/index.vue?00c2","webpack:///./src/api/system-media.js","webpack:///./src/components/SystemMedia/Category.vue?15e6","webpack:///src/components/SystemMedia/Category.vue","webpack:///./src/components/SystemMedia/Category.vue?510a","webpack:///./src/components/SystemMedia/Category.vue","webpack:///./src/components/SystemMedia/Files.vue?03d7","webpack:///src/components/SystemMedia/Files.vue","webpack:///./src/components/SystemMedia/Files.vue?7ba7","webpack:///./src/components/SystemMedia/Files.vue","webpack:///src/components/SystemMedia/index.vue","webpack:///./src/components/SystemMedia/index.vue?ac69","webpack:///./src/components/SystemMedia/index.vue","webpack:///./node_modules/lodash/differenceBy.js","webpack:///./src/components/FilePreview.vue?214f","webpack:///./src/components/LzPopconfirm.vue?761f","webpack:///./src/components/LzPagination.vue?4d21","webpack:///src/components/LzPagination.vue","webpack:///./src/components/LzPagination.vue?4165","webpack:///./src/components/LzPagination.vue","webpack:///./src/components/SystemMedia/Files.vue?87db"],"names":["render","_vm","this","_h","$createElement","_c","_self","_b","attrs","visible","on","onVisibleChange","scopedSlots","_u","key","fn","staticClass","_v","_s","title","_t","onCancel","cancelText","onConfirm","okText","proxy","$attrs","staticRenderFns","name","components","LoadingAction","Space","data","props","type","String","default","confirm","Function","disabled","Boolean","methods","$emit","component","directives","rawName","value","expression","path","url","disableView","_e","$event","stopPropagation","onPreview","formattedFile","width","height","file","computed","isImage","toUpperCase","str","formatFile","f","Object","assign","setImgSize","GlobalModal","propsData","wrapClassName","content","imgEl","naturalWidth","naturalHeight","maxWidth","ratio","maxHeight","watch","handler","immediate","SetCache","arrayIncludes","arrayIncludesWith","arrayMap","baseUnary","cacheHas","LARGE_ARRAY_SIZE","baseDifference","array","values","iteratee","comparator","index","includes","isCommon","length","result","valuesLength","outer","valuesIndex","push","module","exports","realName","class","center","matchedMenusChain","_typeof","obj","Symbol","iterator","constructor","prototype","miniWidth","tinyWidth","ref","onCategorySelect","onCategoriesChange","categoriesDialog","onReloadMedia","anySelected","movingDialog","undefined","defaultMultiple","multiple","onDestroyMedia","media","mediaLoading","uploading","uploadingText","selected","defaultExt","storeMedia","beforeUpload","currentCategoryId","replace","onUploadChange","clearSelected","selectedCount","ext","onOpenExtDialog","getThis","staticStyle","page","onPageChange","onExtFilter","model","callback","$$v","extDialog","indexOf","_k","keyCode","extTemp","onMove","movingTarget","_l","i","id","text","getCategories","params","Request","get","destroyCategory","delete","updateCategory","put","storeCategory","post","FormData","append","getCategoryMedia","categoryId","getMedia","batchUpdateMedia","batchDestroyMedia","_method","q","onOpenDialog","currentId","onDestroyCategory","loading","categories","treeOptions","expandedKeys","autoExpandParent","onFilter","onSelect","onDrop","onExpand","editMode","dialog","form","errors","onSave","$set","node","children","some","parentKey","getParentKey","LzPopconfirm","LzForm","LzFormItem","current","parent_id","folder","$store","state","canSave","cateOptions","flattenCategories","items","forEach","flatten","loop","selectedKeys","e","dataRef","source","target","dropToGap","dropped","setExpandedKeys","newVal","slice","deep","item","isSelected","nativeOn","Array","splice","findInSelected","Files","Category","LzPagination","currentCategory","moving","uploadCount","uploadFail","uploadSuccess","uploadInvalid","categoriesSelectOptions","firstLevel","extArray","split","moveSelected","category","status","$info","$refs","upload","sFileList","lt10M","validExt","res","baseFlatten","baseIteratee","baseRest","isArrayLikeObject","last","differenceBy","pageSizes","total","showSizeChanger","showQuickJumper","perPage","onChange","onSizeChange","currentPage","autoPush","sizes","per_page","$router","$route","query","current_page"],"mappings":"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","file":"js/chunk-5272c0c2.dc1ec6f8.js","sourcesContent":["import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Category.vue?vue&type=style&index=0&id=3742533e&scoped=true&lang=less&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Category.vue?vue&type=style&index=0&id=3742533e&scoped=true&lang=less&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('a-popover',_vm._b({attrs:{\"trigger\":\"click\",\"visible\":_vm.visible},on:{\"visibleChange\":_vm.onVisibleChange},scopedSlots:_vm._u([{key:\"content\",fn:function(){return [_c('div',{staticClass:\"mb-2\"},[(_vm.title)?_c('span',[_vm._v(_vm._s(_vm.title))]):_vm._t(\"title\")],2),_c('space',{staticClass:\"actions\"},[_c('a-button',{attrs:{\"size\":\"small\"},on:{\"click\":_vm.onCancel}},[_vm._v(_vm._s(_vm.cancelText))]),_c('loading-action',{attrs:{\"action\":_vm.onConfirm,\"size\":\"small\",\"type\":\"primary\"}},[_vm._v(\" \"+_vm._s(_vm.okText)+\" \")])],1)]},proxy:true}])},'a-popover',_vm.$attrs,false),[_vm._t(\"default\",null,{\"pop\":this})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <a-popover\r\n    trigger=\"click\"\r\n    :visible=\"visible\"\r\n    v-bind=\"$attrs\"\r\n    @visibleChange=\"onVisibleChange\"\r\n  >\r\n    <template #content>\r\n      <div class=\"mb-2\">\r\n        <span v-if=\"title\">{{ title }}</span>\r\n        <slot v-else name=\"title\"/>\r\n      </div>\r\n      <space class=\"actions\">\r\n        <a-button size=\"small\" @click=\"onCancel\">{{ cancelText }}</a-button>\r\n        <loading-action\r\n          :action=\"onConfirm\"\r\n          size=\"small\"\r\n          type=\"primary\"\r\n        >\r\n          {{ okText }}\r\n        </loading-action>\r\n      </space>\r\n    </template>\r\n    <slot v-bind:pop=\"this\"/>\r\n  </a-popover>\r\n</template>\r\n\r\n<script>\r\nimport Space from '@c/Space'\r\nimport LoadingAction from '@c/LoadingAction'\r\n\r\nexport default {\r\n  name: 'LzPopconfirm',\r\n  components: {\r\n    LoadingAction,\r\n    Space,\r\n  },\r\n  data: () => ({\r\n    visible: false,\r\n  }),\r\n  props: {\r\n    title: {\r\n      type: String,\r\n      default: '确认操作？',\r\n    },\r\n    cancelText: {\r\n      type: String,\r\n      default: '取消',\r\n    },\r\n    okText: {\r\n      type: String,\r\n      default: '确认',\r\n    },\r\n    /**\r\n     * 传入异步函数，就会有 loading 效果\r\n     */\r\n    confirm: Function,\r\n    disabled: Boolean,\r\n  },\r\n  methods: {\r\n    onCancel() {\r\n      this.visible = false\r\n      this.$emit('cancel')\r\n    },\r\n    async onConfirm() {\r\n      this.confirm && await this.confirm()\r\n      this.$emit('confirm')\r\n      this.visible = false\r\n    },\r\n    onVisibleChange(visible) {\r\n      if (this.disabled) {\r\n        return\r\n      }\r\n      this.visible = visible\r\n    },\r\n  },\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.actions {\r\n  display: flex;\r\n  justify-content: flex-end;\r\n  min-width: 130px;\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./LzPopconfirm.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./LzPopconfirm.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./LzPopconfirm.vue?vue&type=template&id=279a699e&scoped=true&\"\nimport script from \"./LzPopconfirm.vue?vue&type=script&lang=js&\"\nexport * from \"./LzPopconfirm.vue?vue&type=script&lang=js&\"\nimport style0 from \"./LzPopconfirm.vue?vue&type=style&index=0&id=279a699e&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"279a699e\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{directives:[{name:\"resize\",rawName:\"v-resize\",value:(_vm.setImgSize),expression:\"setImgSize\"}],staticClass:\"file-preview flex-box\"},[(!_vm.path)?_c('div',{staticClass:\"invalid\",attrs:{\"title\":_vm.path}},[_vm._v(\" 无效 \")]):(_vm.isImage)?_c('img',{staticClass:\"img\",attrs:{\"alt\":_vm.path,\"title\":_vm.path,\"src\":_vm.url}}):_c('div',{staticClass:\"path\",attrs:{\"title\":_vm.path}},[_vm._v(_vm._s(_vm.path))]),_c('div',{staticClass:\"actions flex-box\"},[_c('space',{attrs:{\"size\":\"4\"}},[(!_vm.disableView)?[(_vm.isImage)?_c('a-icon',{attrs:{\"type\":\"eye\",\"title\":\"查看\"},on:{\"click\":function($event){$event.stopPropagation();return _vm.onPreview($event)}}}):_c('a',{attrs:{\"href\":_vm.url,\"target\":\"_blank\",\"title\":\"查看\"}},[_c('a-icon',{attrs:{\"type\":\"eye\"}})],1)]:_vm._e(),_vm._t(\"default\",null,{\"file\":_vm.formattedFile})],2)],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"file-preview flex-box\" v-resize=\"setImgSize\">\r\n    <div\r\n      v-if=\"!path\"\r\n      class=\"invalid\"\r\n      :title=\"path\"\r\n    >\r\n      无效\r\n    </div>\r\n    <img\r\n      v-else-if=\"isImage\"\r\n      class=\"img\"\r\n      :alt=\"path\"\r\n      :title=\"path\"\r\n      :src=\"url\"\r\n    >\r\n    <div class=\"path\" v-else :title=\"path\">{{ path }}</div>\r\n\r\n    <div class=\"actions flex-box\">\r\n      <space size=\"4\">\r\n        <template v-if=\"!disableView\">\r\n          <a-icon\r\n            v-if=\"isImage\"\r\n            type=\"eye\"\r\n            @click.stop=\"onPreview\"\r\n            title=\"查看\"\r\n          />\r\n          <a\r\n            v-else\r\n            :href=\"url\"\r\n            target=\"_blank\"\r\n            title=\"查看\"\r\n          >\r\n            <a-icon type=\"eye\"/>\r\n          </a>\r\n        </template>\r\n        <slot :file=\"formattedFile\"/>\r\n      </space>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { isImage } from '@/libs/validates'\r\nimport { mapState } from 'vuex'\r\nimport { getUrl } from '@/libs/utils'\r\nimport GlobalModal from '@c/GlobalModal'\r\nimport Space from '@c/Space'\r\n\r\nexport default {\r\n  name: 'FilePreview',\r\n  components: {\r\n    Space,\r\n  },\r\n  data() {\r\n    return {\r\n      formattedFile: {\r\n        path: '',\r\n        url: '',\r\n      },\r\n\r\n      width: 0,\r\n      height: 0,\r\n    }\r\n  },\r\n  props: {\r\n    file: null,\r\n    disableView: Boolean,\r\n    ...mapState(['miniWidth']),\r\n  },\r\n  computed: {\r\n    isImage() {\r\n      return isImage(this.formattedFile.path)\r\n    },\r\n    url() {\r\n      return this.formattedFile.url\r\n    },\r\n    path() {\r\n      return this.formattedFile.path\r\n    },\r\n  },\r\n  methods: {\r\n    toUpperCase(str) {\r\n      return str.toUpperCase()\r\n    },\r\n    /**\r\n     * 把传入的 file 值，格式化为一个有几个必要字段（path, url）的对象\r\n     */\r\n    formatFile() {\r\n      const f = this.file\r\n      if (!f) {\r\n        return\r\n      }\r\n\r\n      if (typeof f === 'string') {\r\n        this.formattedFile = {\r\n          path: f,\r\n          url: getUrl(f),\r\n        }\r\n      } else if (typeof f === 'object') {\r\n        this.formattedFile = Object.assign({}, f, {\r\n          path: f.path || '',\r\n          url: f.url || getUrl(f.path),\r\n        })\r\n      }\r\n    },\r\n    onPreview() {\r\n      if (!this.isImage) {\r\n        return\r\n      }\r\n\r\n      this.setImgSize()\r\n\r\n      GlobalModal.new({\r\n        propsData: {\r\n          wrapClassName: 'image-preview-dialog',\r\n          width: 'auto',\r\n          content: (h) => {\r\n            return (\r\n              <img\r\n                src={this.formattedFile.url}\r\n                width={this.width}\r\n                height={this.height}\r\n              />\r\n            )\r\n          },\r\n        },\r\n      })\r\n    },\r\n    setImgSize() {\r\n      if (!this.isImage) {\r\n        return\r\n      }\r\n\r\n      const maxWidth = Math.min(1000, window.innerWidth * 0.9)\r\n      const maxHeight = window.innerHeight * 0.9\r\n\r\n      const imgEl = this.$el.querySelector('.img')\r\n      this.width = imgEl.naturalWidth || 1\r\n      this.height = imgEl.naturalHeight || 1\r\n      const ratio = this.width / this.height\r\n\r\n      if (this.width > maxWidth) {\r\n        this.width = maxWidth\r\n        this.height = this.width / ratio\r\n      }\r\n\r\n      if (this.height > maxHeight) {\r\n        this.height = maxHeight\r\n        this.width = this.height * ratio\r\n      }\r\n    },\r\n  },\r\n  watch: {\r\n    file: {\r\n      handler() {\r\n        this.formatFile()\r\n      },\r\n      immediate: true,\r\n    },\r\n  },\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n@import \"~@/styles/vars\";\r\n\r\n.file-preview {\r\n  width: 100px;\r\n  height: 100px;\r\n  min-width: 100px;\r\n  min-height: 100px;\r\n  overflow: hidden;\r\n  border: @border-base;\r\n  border-radius: 4px;\r\n  margin: 0 5px 5px 0;\r\n  transition: all .3s;\r\n  position: relative;\r\n\r\n  &:hover {\r\n    .actions {\r\n      opacity: 1;\r\n    }\r\n  }\r\n\r\n  img {\r\n    max-width: 100%;\r\n    max-height: 100%;\r\n    word-break: break-all;\r\n  }\r\n\r\n  .path {\r\n    overflow: hidden;\r\n    margin: 0 5px;\r\n    font-size: 12px;\r\n    word-break: break-all;\r\n    line-height: normal;\r\n  }\r\n\r\n  .invalid {\r\n    font-size: 20px;\r\n    font-style: italic;\r\n  }\r\n}\r\n\r\n.actions {\r\n  width: 100%;\r\n  height: 100%;\r\n  position: absolute;\r\n  left: 0;\r\n  top: 0;\r\n  opacity: 0;\r\n  background: rgba(0, 0, 0, 0.6);\r\n  transition: all .3s;\r\n\r\n  > * {\r\n    font-size: 24px;\r\n    cursor: pointer;\r\n    text-decoration: none;\r\n    color: @blue-6;\r\n  }\r\n}\r\n</style>\r\n\r\n<style lang=\"less\">\r\n.image-preview-dialog {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n\r\n  .ant-modal {\r\n    width: auto;\r\n    display: inline-block;\r\n    top: auto;\r\n    padding: 0;\r\n  }\r\n\r\n  .ant-modal-body {\r\n    padding: 0;\r\n    border-radius: 4px;\r\n  }\r\n\r\n  img {\r\n    border-radius: 4px;\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FilePreview.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FilePreview.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./FilePreview.vue?vue&type=template&id=1b18567e&scoped=true&\"\nimport script from \"./FilePreview.vue?vue&type=script&lang=js&\"\nexport * from \"./FilePreview.vue?vue&type=script&lang=js&\"\nimport style0 from \"./FilePreview.vue?vue&type=style&index=0&id=1b18567e&scoped=true&lang=less&\"\nimport style1 from \"./FilePreview.vue?vue&type=style&index=1&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1b18567e\",\n  null\n  \n)\n\nexport default component.exports","var SetCache = require('./_SetCache'),\n    arrayIncludes = require('./_arrayIncludes'),\n    arrayIncludesWith = require('./_arrayIncludesWith'),\n    arrayMap = require('./_arrayMap'),\n    baseUnary = require('./_baseUnary'),\n    cacheHas = require('./_cacheHas');\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * The base implementation of methods like `_.difference` without support\n * for excluding multiple arrays or iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Array} values The values to exclude.\n * @param {Function} [iteratee] The iteratee invoked per element.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new array of filtered values.\n */\nfunction baseDifference(array, values, iteratee, comparator) {\n  var index = -1,\n      includes = arrayIncludes,\n      isCommon = true,\n      length = array.length,\n      result = [],\n      valuesLength = values.length;\n\n  if (!length) {\n    return result;\n  }\n  if (iteratee) {\n    values = arrayMap(values, baseUnary(iteratee));\n  }\n  if (comparator) {\n    includes = arrayIncludesWith;\n    isCommon = false;\n  }\n  else if (values.length >= LARGE_ARRAY_SIZE) {\n    includes = cacheHas;\n    isCommon = false;\n    values = new SetCache(values);\n  }\n  outer:\n  while (++index < length) {\n    var value = array[index],\n        computed = iteratee == null ? value : iteratee(value);\n\n    value = (comparator || value !== 0) ? value : 0;\n    if (isCommon && computed === computed) {\n      var valuesIndex = valuesLength;\n      while (valuesIndex--) {\n        if (values[valuesIndex] === computed) {\n          continue outer;\n        }\n      }\n      result.push(value);\n    }\n    else if (!includes(values, computed, comparator)) {\n      result.push(value);\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseDifference;\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{staticClass:\"content-header\"},[_c('span',{staticClass:\"title\"},[_vm._v(_vm._s(_vm.realName))]),_c('div',{staticClass:\"flex-spacer\"}),_c('div',[_vm._t(\"actions\")],2)]),_c('div',{class:{ center: _vm.center }},[_vm._t(\"default\")],2)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <div class=\"content-header\">\r\n      <span class=\"title\">{{ realName }}</span>\r\n      <div class=\"flex-spacer\"/>\r\n      <div>\r\n        <slot name=\"actions\"/>\r\n      </div>\r\n    </div>\r\n    <div :class=\"{ center }\">\r\n      <slot/>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n\r\nimport { mapState } from 'vuex'\r\nimport _last from 'lodash/last'\r\n\r\nexport default {\r\n  name: 'PageContent',\r\n  props: {\r\n    title: String,\r\n    center: Boolean,\r\n  },\r\n  computed: {\r\n    ...mapState({\r\n      matchedMenusChain: (state) => state.matchedMenusChain,\r\n    }),\r\n    realName() {\r\n      if (this.title) {\r\n        return this.title\r\n      }\r\n\r\n      let title = ''\r\n      if (this.matchedMenusChain.length) {\r\n        title = _last(this.matchedMenusChain).title\r\n      }\r\n\r\n      return title || this.$route?.meta?.title || ''\r\n    },\r\n  },\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.content-header {\r\n  height: 40px;\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.title {\r\n  font-size: 20px;\r\n  font-weight: 600;\r\n}\r\n\r\n.center {\r\n  display: flex;\r\n  justify-content: center;\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PageContent.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PageContent.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./PageContent.vue?vue&type=template&id=68034d40&scoped=true&\"\nimport script from \"./PageContent.vue?vue&type=script&lang=js&\"\nexport * from \"./PageContent.vue?vue&type=script&lang=js&\"\nimport style0 from \"./PageContent.vue?vue&type=style&index=0&id=68034d40&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"68034d40\",\n  null\n  \n)\n\nexport default component.exports","export default function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FilePreview.vue?vue&type=style&index=1&lang=less&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FilePreview.vue?vue&type=style&index=1&lang=less&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PageContent.vue?vue&type=style&index=0&id=68034d40&scoped=true&lang=less&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PageContent.vue?vue&type=style&index=0&id=68034d40&scoped=true&lang=less&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./LzPagination.vue?vue&type=style&index=0&id=453ab4ed&scoped=true&lang=less&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./LzPagination.vue?vue&type=style&index=0&id=453ab4ed&scoped=true&lang=less&\"","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=31f498c1&scoped=true&lang=less&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=31f498c1&scoped=true&lang=less&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"system-media\",class:{\n    'mini-width': _vm.miniWidth,\n    'tiny-width': _vm.tinyWidth,\n  }},[(!_vm.miniWidth)?_c('div',{staticClass:\"sider\"},[_c('category',{ref:\"category\",staticClass:\"h-100\",on:{\"select\":_vm.onCategorySelect,\"categories-change\":_vm.onCategoriesChange}})],1):_vm._e(),_c('div',{staticClass:\"content\"},[_c('div',{staticClass:\"header\"},[_c('space',[(_vm.miniWidth)?_c('a-button',{on:{\"click\":function($event){_vm.categoriesDialog = true}}},[_vm._v(\"选择分类\")]):_vm._e(),_c('loading-action',{attrs:{\"action\":_vm.onReloadMedia}},[_vm._v(\"刷新\")]),_c('a-button',{attrs:{\"disabled\":!_vm.anySelected},on:{\"click\":function($event){_vm.movingDialog = true}}},[_vm._v(\"移动\")]),(_vm.defaultMultiple === undefined)?_c('a-button',{attrs:{\"type\":_vm.multiple ? 'primary' : ''},on:{\"click\":function($event){_vm.multiple = !_vm.multiple}}},[_vm._v(\" 多选 \")]):_vm._e(),_c('lz-popconfirm',{attrs:{\"title\":\"物理文件也有可能会被删除！确认删除？\",\"type\":\"danger\",\"disabled\":!_vm.anySelected,\"confirm\":_vm.onDestroyMedia}},[_c('a-button',{attrs:{\"type\":\"danger\",\"disabled\":!_vm.anySelected}},[_vm._v(\"删除\")])],1)],1)],1),_c('a-spin',{staticClass:\"files\",class:{ 'files-empty': _vm.media.length === 0 },attrs:{\"spinning\":_vm.mediaLoading || _vm.uploading,\"tip\":_vm.uploadingText}},[_c('files',{ref:\"media\",attrs:{\"media\":_vm.media,\"multiple\":_vm.multiple,\"selected\":_vm.selected,\"ext\":_vm.defaultExt},on:{\"update:selected\":function($event){_vm.selected=$event}}}),_c('a-empty',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.media.length === 0 && !_vm.mediaLoading),expression:\"media.length === 0 && !mediaLoading\"}]})],1),_c('div',{staticClass:\"footer\"},[_c('space',[_c('a-upload',{ref:\"upload\",attrs:{\"custom-request\":_vm.storeMedia,\"before-upload\":_vm.beforeUpload,\"show-upload-list\":false,\"disabled\":_vm.currentCategoryId <= 0,\"multiple\":\"\",\"accept\":'.' + (_vm.defaultExt ? _vm.defaultExt : '').replace(/,/g, ',.')},on:{\"change\":_vm.onUploadChange}},[_c('a-button',{attrs:{\"disabled\":_vm.currentCategoryId <= 0,\"title\":_vm.currentCategoryId <= 0 ? '请先选择分类' : ''}},[_vm._v(\" 上传 \")])],1),_c('a-button',{attrs:{\"disabled\":!_vm.anySelected},on:{\"click\":_vm.clearSelected}},[_vm._v(\" 清空 \"+_vm._s(this.selectedCount ? (\"(\" + (this.selectedCount) + \")\") : '')+\" \")]),_c('a-button',{attrs:{\"disabled\":!!_vm.defaultExt,\"title\":_vm.ext,\"type\":_vm.ext ? 'primary' : null},on:{\"click\":_vm.onOpenExtDialog}},[_vm._v(\" \"+_vm._s(_vm.ext ? '已筛选' : '筛选')+\" \")]),_vm._t(\"actions\",null,null,_vm.getThis)],2),_c('div',{staticClass:\"flex-spacer\"}),_c('lz-pagination',{staticStyle:{\"height\":\"auto\"},attrs:{\"page\":_vm.page,\"auto-push\":false,\"show-quick-jumper\":false,\"show-size-changer\":false,\"hide-on-single-page\":\"\",\"simple\":\"\"},on:{\"current-change\":_vm.onPageChange}})],1)],1),(!_vm.defaultExt)?_c('a-modal',{attrs:{\"title\":\"筛选类型\",\"width\":\"400px\"},on:{\"ok\":_vm.onExtFilter},model:{value:(_vm.extDialog),callback:function ($$v) {_vm.extDialog=$$v},expression:\"extDialog\"}},[_c('a-input',{attrs:{\"focus\":\"\",\"allow-clear\":\"\"},on:{\"keydown\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.onExtFilter($event)}},model:{value:(_vm.extTemp),callback:function ($$v) {_vm.extTemp=$$v},expression:\"extTemp\"}})],1):_vm._e(),_c('a-modal',{attrs:{\"title\":\"移动文件\",\"width\":\"400px\"},scopedSlots:_vm._u([{key:\"footer\",fn:function(){return [_c('a-button',{on:{\"click\":function($event){_vm.movingDialog = false}}},[_vm._v(\"取消\")]),_c('loading-action',{attrs:{\"type\":\"primary\",\"action\":_vm.onMove,\"disabled\":!_vm.movingTarget}},[_vm._v(\" 移动 \")])]},proxy:true}]),model:{value:(_vm.movingDialog),callback:function ($$v) {_vm.movingDialog=$$v},expression:\"movingDialog\"}},[_c('a-select',{staticClass:\"w-100\",attrs:{\"show-search\":\"\",\"option-filter-prop\":\"title\",\"option-label-prop\":\"title\"},model:{value:(_vm.movingTarget),callback:function ($$v) {_vm.movingTarget=$$v},expression:\"movingTarget\"}},_vm._l((_vm.categoriesSelectOptions),function(i){return _c('a-select-option',{key:i.id,attrs:{\"title\":i.title}},[_vm._v(\" \"+_vm._s(i.text)+\" \")])}),1)],1),(_vm.miniWidth)?_c('a-modal',{attrs:{\"title\":\"选择分类\",\"footer\":null},model:{value:(_vm.categoriesDialog),callback:function ($$v) {_vm.categoriesDialog=$$v},expression:\"categoriesDialog\"}},[_c('category',{ref:\"category\",staticClass:\"h-100\",on:{\"select\":_vm.onCategorySelect,\"categories-change\":_vm.onCategoriesChange}})],1):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import Request from '@/axios/request'\r\n\r\nexport function getCategories(params = {}) {\r\n  return Request.get('system-media-categories', {\r\n    params,\r\n  })\r\n}\r\n\r\nexport function destroyCategory(id) {\r\n  return Request.delete(`system-media-categories/${id}`)\r\n}\r\n\r\nexport function updateCategory(id, data) {\r\n  return Request.put(`system-media-categories/${id}`, data)\r\n}\r\n\r\nexport function storeCategory(data) {\r\n  return Request.post('system-media-categories', data)\r\n}\r\n\r\nexport function storeMedia(id, file) {\r\n  const data = new FormData()\r\n  data.append('file', file)\r\n\r\n  return Request.post(`system-media-categories/${id}/system-media`, data)\r\n}\r\n\r\nexport function getCategoryMedia(categoryId, params = {}) {\r\n  return Request.get(`system-media-categories/${categoryId}/system-media`, {\r\n    params,\r\n  })\r\n}\r\n\r\nexport function getMedia(params = {}) {\r\n  return Request.get('system-media', {\r\n    params,\r\n  })\r\n}\r\n\r\nexport function batchUpdateMedia(data) {\r\n  return Request.put('system-media', data)\r\n}\r\n\r\n// DELETE 方法不能传数据，利用 Laravel 的请求方法伪造\r\nexport function batchDestroyMedia(id) {\r\n  return Request.post('system-media', {\r\n    _method: 'DELETE',\r\n    id,\r\n  })\r\n}\r\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"category\"},[_c('a-input',{staticClass:\"filter-input mb-1\",class:{ 'w-100': _vm.miniWidth },attrs:{\"placeholder\":\"搜索分类\"},model:{value:(_vm.q),callback:function ($$v) {_vm.q=$$v},expression:\"q\"}}),_c('a-button-group',{staticClass:\"category-actions mb-2\",class:{ 'w-100': _vm.miniWidth }},[_c('loading-action',{attrs:{\"action\":_vm.getCategories,\"disable-text-when-loading\":\"\"}},[_vm._v(\"刷新\")]),_c('a-button',{on:{\"click\":function($event){return _vm.onOpenDialog(false)}}},[_vm._v(\"添加\")]),_c('a-button',{attrs:{\"disabled\":_vm.currentId <= 0},on:{\"click\":function($event){return _vm.onOpenDialog(true)}}},[_vm._v(\"编辑\")]),_c('lz-popconfirm',{attrs:{\"disabled\":_vm.currentId <= 0,\"overlay-style\":{ width: '200px' },\"confirm\":_vm.onDestroyCategory,\"title\":\"所有子孙分类也将被删除!分类下的文件会被移动到“无分类”下。确认删除？\"}},[_c('a-button',{attrs:{\"type\":\"danger\",\"disabled\":_vm.currentId <= 0}},[_vm._v(\"删除\")])],1)],1),_c('a-spin',{staticClass:\"categories\",attrs:{\"spinning\":_vm.loading}},[(this.categories.length)?_c('a-tree',{attrs:{\"tree-data\":_vm.categories,\"replace-fields\":_vm.treeOptions,\"default-expand-all\":\"\",\"selected-keys\":[_vm.currentId],\"block-node\":\"\",\"draggable\":\"\",\"expanded-keys\":_vm.expandedKeys,\"auto-expand-parent\":_vm.autoExpandParent,\"filter-tree-node\":_vm.onFilter},on:{\"select\":_vm.onSelect,\"drop\":_vm.onDrop,\"expand\":_vm.onExpand}}):_vm._e()],1),_c('a-modal',{attrs:{\"title\":_vm.editMode ? '编辑分类' : '添加分类',\"footer\":null,\"width\":\"400px\"},model:{value:(_vm.dialog),callback:function ($$v) {_vm.dialog=$$v},expression:\"dialog\"}},[_c('lz-form',{attrs:{\"disable-redirect\":\"\",\"form\":_vm.form,\"errors\":_vm.errors,\"submit\":_vm.onSave,\"in-dialog\":\"\",\"layout\":\"vertical\",\"enter-to-submit\":\"\",\"edit-mode\":_vm.editMode},on:{\"update:form\":function($event){_vm.form=$event},\"update:errors\":function($event){_vm.errors=$event}}},[_c('lz-form-item',{attrs:{\"label\":\"父级\",\"prop\":\"parent_id\"}},[_c('a-select',{attrs:{\"show-search\":\"\",\"option-filter-prop\":\"title\",\"option-label-prop\":\"title\"},model:{value:(_vm.form.parent_id),callback:function ($$v) {_vm.$set(_vm.form, \"parent_id\", $$v)},expression:\"form.parent_id\"}},_vm._l((_vm.cateOptions),function(i){return _c('a-select-option',{key:i.id,attrs:{\"title\":i.title}},[_vm._v(\" \"+_vm._s(i.text)+\" \")])}),1)],1),_c('lz-form-item',{attrs:{\"label\":\"名称\",\"required\":\"\",\"prop\":\"name\"}},[_c('a-input',{attrs:{\"focus\":\"\"},model:{value:(_vm.form.name),callback:function ($$v) {_vm.$set(_vm.form, \"name\", $$v)},expression:\"form.name\"}})],1),_c('lz-form-item',{attrs:{\"label\":\"文件夹\",\"prop\":\"folder\"}},[_c('a-input',{model:{value:(_vm.form.folder),callback:function ($$v) {_vm.$set(_vm.form, \"folder\", $$v)},expression:\"form.folder\"}})],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"category\">\r\n    <a-input\r\n      class=\"filter-input mb-1\"\r\n      :class=\"{ 'w-100': miniWidth }\"\r\n      placeholder=\"搜索分类\"\r\n      v-model=\"q\"\r\n    />\r\n    <a-button-group class=\"category-actions mb-2\" :class=\"{ 'w-100': miniWidth }\">\r\n      <loading-action :action=\"getCategories\" disable-text-when-loading>刷新</loading-action>\r\n      <a-button @click=\"onOpenDialog(false)\">添加</a-button>\r\n      <a-button :disabled=\"currentId <= 0\" @click=\"onOpenDialog(true)\">编辑</a-button>\r\n      <lz-popconfirm\r\n        :disabled=\"currentId <= 0\"\r\n        :overlay-style=\"{ width: '200px' }\"\r\n        :confirm=\"onDestroyCategory\"\r\n        title=\"所有子孙分类也将被删除!分类下的文件会被移动到“无分类”下。确认删除？\"\r\n      >\r\n        <a-button type=\"danger\" :disabled=\"currentId <= 0\">删除</a-button>\r\n      </lz-popconfirm>\r\n    </a-button-group>\r\n    <a-spin class=\"categories\" :spinning=\"loading\">\r\n      <a-tree\r\n        v-if=\"this.categories.length\"\r\n        :tree-data=\"categories\"\r\n        :replace-fields=\"treeOptions\"\r\n        default-expand-all\r\n        :selected-keys=\"[currentId]\"\r\n        block-node\r\n        @select=\"onSelect\"\r\n        draggable\r\n        @drop=\"onDrop\"\r\n        :expanded-keys=\"expandedKeys\"\r\n        :auto-expand-parent=\"autoExpandParent\"\r\n        :filter-tree-node=\"onFilter\"\r\n        @expand=\"onExpand\"\r\n      />\r\n    </a-spin>\r\n\r\n    <a-modal\r\n      :title=\"editMode ? '编辑分类' : '添加分类'\"\r\n      v-model=\"dialog\"\r\n      :footer=\"null\"\r\n      width=\"400px\"\r\n    >\r\n      <lz-form\r\n        disable-redirect\r\n        :form.sync=\"form\"\r\n        :errors.sync=\"errors\"\r\n        :submit=\"onSave\"\r\n        in-dialog\r\n        layout=\"vertical\"\r\n        enter-to-submit\r\n        :edit-mode=\"editMode\"\r\n      >\r\n        <lz-form-item label=\"父级\" prop=\"parent_id\">\r\n          <a-select\r\n            v-model=\"form.parent_id\"\r\n            show-search\r\n            option-filter-prop=\"title\"\r\n            option-label-prop=\"title\"\r\n          >\r\n            <a-select-option\r\n              v-for=\"i of cateOptions\"\r\n              :key=\"i.id\"\r\n              :title=\"i.title\"\r\n            >\r\n              {{ i.text }}\r\n            </a-select-option>\r\n          </a-select>\r\n        </lz-form-item>\r\n        <lz-form-item label=\"名称\" required prop=\"name\">\r\n          <a-input v-model=\"form.name\" focus/>\r\n        </lz-form-item>\r\n        <lz-form-item label=\"文件夹\" prop=\"folder\">\r\n          <a-input v-model=\"form.folder\"/>\r\n        </lz-form-item>\r\n      </lz-form>\r\n    </a-modal>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n  destroyCategory,\r\n  getCategories,\r\n  storeCategory,\r\n  updateCategory,\r\n} from '@/api/system-media'\r\nimport _get from 'lodash/get'\r\nimport LzPopconfirm from '@c/LzPopconfirm'\r\nimport {\r\n  getMessage,\r\n  nestedToSelectOptions,\r\n  removeFromNested,\r\n} from '@/libs/utils'\r\nimport LoadingAction from '@c/LoadingAction'\r\nimport LzForm from '@c/LzForm/index'\r\nimport LzFormItem from '@c/LzForm/LzFormItem'\r\n\r\nconst getParentKey = (id, tree) => {\r\n  let parentKey\r\n  for (let i = 0; i < tree.length; i++) {\r\n    const node = tree[i]\r\n    if (node.children) {\r\n      if (node.children.some(item => item.id === id)) {\r\n        parentKey = node.id\r\n      } else if (getParentKey(id, node.children)) {\r\n        parentKey = getParentKey(id, node.children)\r\n      }\r\n    }\r\n  }\r\n  return parentKey\r\n}\r\n\r\nexport default {\r\n  name: 'Category',\r\n  components: {\r\n    LzPopconfirm,\r\n    LoadingAction,\r\n    LzForm,\r\n    LzFormItem,\r\n  },\r\n  data() {\r\n    return {\r\n      treeOptions: {\r\n        children: 'children',\r\n        title: 'name',\r\n        key: 'id',\r\n      },\r\n\r\n      q: '', // 分类筛选\r\n      expandedKeys: [],\r\n      autoExpandParent: true,\r\n\r\n      categories: [],\r\n      loading: false,\r\n      current: null,\r\n\r\n      editMode: false, // 编辑或者添加时，用的同一个弹框\r\n      dialog: false,\r\n\r\n      form: {\r\n        parent_id: 0,\r\n        name: '',\r\n        folder: '',\r\n      },\r\n      errors: {},\r\n    }\r\n  },\r\n  computed: {\r\n    currentId() {\r\n      return _get(this.current, 'id', -1)\r\n    },\r\n    miniWidth() {\r\n      return this.$store.state.miniWidth\r\n    },\r\n    canSave() {\r\n      // 添加 或者 编辑时，ID 大于 0\r\n      return !this.editMode || this.currentId > 0\r\n    },\r\n    cateOptions() {\r\n      return nestedToSelectOptions(this.categories.slice(2), {\r\n        title: 'name',\r\n      })\r\n    },\r\n    flattenCategories() {\r\n      const flatten = []\r\n      const loop = (items) => {\r\n        items.forEach((i) => {\r\n          flatten.push({\r\n            id: i.id,\r\n            name: i.name,\r\n          })\r\n          loop(i.children || [])\r\n        })\r\n      }\r\n\r\n      loop(this.categories)\r\n\r\n      return flatten\r\n    },\r\n  },\r\n  async created() {\r\n    await this.getCategories()\r\n    this.initSelected()\r\n  },\r\n  methods: {\r\n    async getCategories() {\r\n      this.loading = true\r\n      try {\r\n        const { data } = await getCategories()\r\n\r\n        // 追加两个伪分类，但是同步到父组件时，要去掉\r\n        this.categories = [\r\n          {\r\n            id: -1,\r\n            name: '所有',\r\n          },\r\n          {\r\n            id: 0,\r\n            name: '无分类',\r\n          },\r\n          ...data,\r\n        ]\r\n      } finally {\r\n        this.loading = false\r\n      }\r\n    },\r\n    async initSelected() {\r\n      await this.$nextTick()\r\n      this.current = this.categories[0]\r\n    },\r\n    onOpenDialog(editMode = true) {\r\n      this.editMode = editMode\r\n\r\n      if (!this.canSave) {\r\n        return\r\n      }\r\n\r\n      this.form = {\r\n        parent_id: editMode\r\n          ? this.current.parent_id\r\n          : (this.currentId < 0) ? 0 : this.currentId,\r\n        name: editMode ? this.current.name : '',\r\n        folder: editMode ? this.current.folder : '',\r\n      }\r\n\r\n      this.dialog = true\r\n    },\r\n    async onDestroyCategory() {\r\n      const id = this.currentId\r\n\r\n      if (id <= 0) {\r\n        return\r\n      }\r\n\r\n      await destroyCategory(id)\r\n      this.$message.success(getMessage('destroyed'))\r\n\r\n      this.initSelected()\r\n\r\n      removeFromNested(this.categories, id)\r\n    },\r\n    onSelect(selectedKeys, e) {\r\n      if (selectedKeys.length) {\r\n        this.current = e.node.dataRef\r\n      }\r\n    },\r\n    async updateCategory(category, data, showValidationMsg = true) {\r\n      const res = await updateCategory(category.id, data)\r\n        .setConfig({\r\n          showValidationMsg,\r\n          validationForm: showValidationMsg ? null : this,\r\n        })\r\n\r\n      category.name = res.data.name\r\n      category.parent_id = res.data.parent_id\r\n    },\r\n    async onSave($form) {\r\n      if (!this.canSave) {\r\n        return\r\n      }\r\n\r\n      if (this.editMode) {\r\n        await this.updateCategory(this.current, this.form, false)\r\n      } else {\r\n        await storeCategory(this.form).setConfig({ validationForm: this })\r\n      }\r\n\r\n      if ($form.stay) {\r\n        $form.onReset()\r\n      } else {\r\n        this.dialog = false\r\n      }\r\n\r\n      this.getCategories()\r\n    },\r\n    onDrop({ dragNode, node, dropToGap }) {\r\n      const source = dragNode.dataRef\r\n      const target = node.dataRef\r\n\r\n      if (source.id <= 0 || target.id <= 0) {\r\n        return\r\n      }\r\n\r\n      // 同级之间，只能拖放到其内部，不能拖放到前后（相当于拖放排序）\r\n      if ((source.parent_id === target.parent_id) && dropToGap) {\r\n        return\r\n      }\r\n\r\n      // 拖放到自己的父级内，相当于没拖动\r\n      if (source.parent_id === target.id && !dropToGap) {\r\n        return\r\n      }\r\n\r\n      this.dropped(source, target, dropToGap)\r\n    },\r\n    async dropped(source, target, dropToGap) {\r\n      // 父级分类 id\r\n      let id = 0\r\n      // 如果拖动到间隙，则与目标同级\r\n      if (dropToGap) {\r\n        id = target.parent_id\r\n      } else {\r\n        id = target.id\r\n      }\r\n\r\n      await this.updateCategory(source, { parent_id: id }, true)\r\n      // 直接重新请求数据，省事，，，\r\n      this.getCategories()\r\n    },\r\n    onFilter(node) {\r\n      return this.q && node.title.indexOf(this.q) > -1\r\n    },\r\n    onExpand(expandedKeys) {\r\n      this.expandedKeys = expandedKeys\r\n      this.autoExpandParent = false\r\n    },\r\n    setExpandedKeys() {\r\n      this.expandedKeys = this.flattenCategories\r\n        .map((item) => {\r\n          if (item.name.indexOf(this.q) > -1) {\r\n            return getParentKey(item.id, this.categories)\r\n          }\r\n          return null\r\n        })\r\n        .filter((item, i, self) => item && self.indexOf(item) === i)\r\n\r\n      this.autoExpandParent = true\r\n    },\r\n  },\r\n  watch: {\r\n    q: {\r\n      handler() {\r\n        this.setExpandedKeys()\r\n      },\r\n      immediate: true,\r\n    },\r\n    flattenCategories() {\r\n      this.setExpandedKeys()\r\n    },\r\n    current: {\r\n      handler(newVal) {\r\n        this.$emit('select', newVal)\r\n      },\r\n      immediate: true,\r\n    },\r\n    categories: {\r\n      handler(newVal) {\r\n        // 去掉前面两个 伪分类\r\n        this.$emit('categories-change', newVal.slice(2))\r\n      },\r\n      deep: true,\r\n    },\r\n    dialog(newVal) {\r\n      if (!newVal) {\r\n        this.errors = {}\r\n        this.form = {\r\n          parent_id: 0,\r\n          name: '',\r\n        }\r\n      }\r\n    },\r\n  },\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.category-actions {\r\n  display: flex;\r\n\r\n  > * {\r\n    width: 25%;\r\n    padding: 0;\r\n  }\r\n\r\n  > span button {\r\n    width: 100%;\r\n    padding: 0;\r\n  }\r\n}\r\n\r\n.category {\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.categories {\r\n  overflow: auto;\r\n  flex: 1;\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Category.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Category.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Category.vue?vue&type=template&id=3742533e&scoped=true&\"\nimport script from \"./Category.vue?vue&type=script&lang=js&\"\nexport * from \"./Category.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Category.vue?vue&type=style&index=0&id=3742533e&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3742533e\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"file-wrapper\"},_vm._l((_vm.media),function(item,i){return _c('file-preview',{key:item.id,class:{ selected: _vm.isSelected(item) },attrs:{\"file\":item},nativeOn:{\"click\":function($event){return _vm.onSelect(item, i)}}})}),1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"file-wrapper\">\r\n    <file-preview\r\n      v-for=\"(item, i) of media\"\r\n      :class=\"{ selected: isSelected(item) }\"\r\n      :key=\"item.id\"\r\n      @click.native=\"onSelect(item, i)\"\r\n      :file=\"item\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport _findIndex from 'lodash/findIndex'\r\nimport { mapConstants } from '@/libs/constants'\r\nimport { isImage } from '@/libs/validates'\r\nimport FilePreview from '@c/FilePreview'\r\n\r\nexport default {\r\n  name: 'Files',\r\n  components: { FilePreview },\r\n  props: {\r\n    media: Array,\r\n    multiple: Boolean,\r\n    selected: Array,\r\n    ext: String,\r\n  },\r\n  computed: {\r\n    ...mapConstants(['IMAGE_EXTS']),\r\n  },\r\n  methods: {\r\n    onSelect(media, index) {\r\n      // 不是特定的类型，不能选择\r\n      if (\r\n        this.ext &&\r\n        this.ext.split(',').indexOf(media.ext ? media.ext.toLowerCase() : '') === -1\r\n      ) {\r\n        return\r\n      }\r\n\r\n      const i = this.findInSelected(media)\r\n\r\n      if (i !== -1) { // 已经选了，则取消选择\r\n        this.selected.splice(i, 1)\r\n      } else { // 否则加入选择\r\n        if (this.multiple) {\r\n          this.selected.push(media)\r\n        } else {\r\n          this.$emit('update:selected', [media])\r\n        }\r\n      }\r\n\r\n      this.$emit('select', this.selected, media, index, (i === -1))\r\n    },\r\n    findInSelected(media) {\r\n      return _findIndex(this.selected, (i) => i.id === media.id)\r\n    },\r\n    isSelected(media) {\r\n      return this.findInSelected(media) !== -1\r\n    },\r\n    isImage,\r\n    toUpperCase(str) {\r\n      return str.toUpperCase()\r\n    },\r\n  },\r\n  watch: {\r\n    multiple(newVal) {\r\n      // 切换为单选时，只保留第一个\r\n      if (!newVal) {\r\n        this.selected.splice(1)\r\n      }\r\n    },\r\n  },\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n@import \"~@/styles/vars\";\r\n\r\n.file-wrapper {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n\r\n  .file-preview {\r\n    border: 3px @border-style-base @border-color-base;\r\n    cursor: pointer;\r\n    border-radius: 0;\r\n\r\n    &.selected {\r\n      border-color: @primary-color;\r\n      border-style: dashed;\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Files.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Files.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Files.vue?vue&type=template&id=5b04a1dc&scoped=true&\"\nimport script from \"./Files.vue?vue&type=script&lang=js&\"\nexport * from \"./Files.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Files.vue?vue&type=style&index=0&id=5b04a1dc&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5b04a1dc\",\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <div\r\n    class=\"system-media\"\r\n    :class=\"{\r\n      'mini-width': miniWidth,\r\n      'tiny-width': tinyWidth,\r\n    }\"\r\n  >\r\n    <div class=\"sider\" v-if=\"!miniWidth\">\r\n      <category\r\n        class=\"h-100\"\r\n        ref=\"category\"\r\n        @select=\"onCategorySelect\"\r\n        @categories-change=\"onCategoriesChange\"\r\n      />\r\n    </div>\r\n    <div class=\"content\">\r\n      <div class=\"header\">\r\n        <space>\r\n          <a-button v-if=\"miniWidth\" @click=\"categoriesDialog = true\">选择分类</a-button>\r\n          <loading-action :action=\"onReloadMedia\">刷新</loading-action>\r\n          <a-button :disabled=\"!anySelected\" @click=\"movingDialog = true\">移动</a-button>\r\n          <a-button\r\n            :type=\"multiple ? 'primary' : ''\"\r\n            v-if=\"defaultMultiple === undefined\"\r\n            @click=\"multiple = !multiple\"\r\n          >\r\n            多选\r\n          </a-button>\r\n          <lz-popconfirm\r\n            title=\"物理文件也有可能会被删除！确认删除？\"\r\n            type=\"danger\"\r\n            :disabled=\"!anySelected\"\r\n            :confirm=\"onDestroyMedia\"\r\n          >\r\n            <a-button type=\"danger\" :disabled=\"!anySelected\">删除</a-button>\r\n          </lz-popconfirm>\r\n        </space>\r\n      </div>\r\n      <a-spin\r\n        class=\"files\"\r\n        :class=\"{ 'files-empty': media.length === 0 }\"\r\n        :spinning=\"mediaLoading || uploading\"\r\n        :tip=\"uploadingText\"\r\n      >\r\n        <files\r\n          ref=\"media\"\r\n          :media=\"media\"\r\n          :multiple=\"multiple\"\r\n          :selected.sync=\"selected\"\r\n          :ext=\"defaultExt\"\r\n        />\r\n        <a-empty v-show=\"media.length === 0 && !mediaLoading\"/>\r\n      </a-spin>\r\n      <div class=\"footer\">\r\n        <space>\r\n          <a-upload\r\n            ref=\"upload\"\r\n            :custom-request=\"storeMedia\"\r\n            :before-upload=\"beforeUpload\"\r\n            :show-upload-list=\"false\"\r\n            :disabled=\"currentCategoryId <= 0\"\r\n            multiple\r\n            :accept=\"'.' + (defaultExt ? defaultExt : '').replace(/,/g, ',.')\"\r\n            @change=\"onUploadChange\"\r\n          >\r\n            <a-button\r\n              :disabled=\"currentCategoryId <= 0\"\r\n              :title=\"currentCategoryId <= 0 ? '请先选择分类' : ''\"\r\n            >\r\n              上传\r\n            </a-button>\r\n          </a-upload>\r\n          <a-button\r\n            :disabled=\"!anySelected\"\r\n            @click=\"clearSelected\"\r\n          >\r\n            清空 {{ this.selectedCount ? `(${this.selectedCount})` : '' }}\r\n          </a-button>\r\n          <a-button\r\n            :disabled=\"!!defaultExt\"\r\n            @click=\"onOpenExtDialog\"\r\n            :title=\"ext\"\r\n            :type=\"ext ? 'primary' : null\"\r\n          >\r\n            {{ ext ? '已筛选' : '筛选' }}\r\n          </a-button>\r\n          <slot name=\"actions\" v-bind=\"getThis\"/>\r\n        </space>\r\n        <div class=\"flex-spacer\"/>\r\n        <lz-pagination\r\n          style=\"height: auto;\"\r\n          :page=\"page\"\r\n          :auto-push=\"false\"\r\n          :show-quick-jumper=\"false\"\r\n          :show-size-changer=\"false\"\r\n          hide-on-single-page\r\n          simple\r\n          @current-change=\"onPageChange\"\r\n        />\r\n      </div>\r\n    </div>\r\n\r\n    <a-modal\r\n      v-if=\"!defaultExt\"\r\n      title=\"筛选类型\"\r\n      v-model=\"extDialog\"\r\n      width=\"400px\"\r\n      @ok=\"onExtFilter\"\r\n    >\r\n      <a-input\r\n        v-model=\"extTemp\"\r\n        @keydown.enter=\"onExtFilter\"\r\n        focus\r\n        allow-clear\r\n      />\r\n    </a-modal>\r\n\r\n    <a-modal\r\n      title=\"移动文件\"\r\n      v-model=\"movingDialog\"\r\n      width=\"400px\"\r\n    >\r\n      <a-select\r\n        class=\"w-100\"\r\n        v-model=\"movingTarget\"\r\n        show-search\r\n        option-filter-prop=\"title\"\r\n        option-label-prop=\"title\"\r\n      >\r\n        <a-select-option\r\n          v-for=\"i of categoriesSelectOptions\"\r\n          :key=\"i.id\"\r\n          :title=\"i.title\"\r\n        >\r\n          {{ i.text }}\r\n        </a-select-option>\r\n      </a-select>\r\n\r\n      <template #footer>\r\n        <a-button @click=\"movingDialog = false\">取消</a-button>\r\n        <loading-action\r\n          type=\"primary\"\r\n          :action=\"onMove\"\r\n          :disabled=\"!movingTarget\"\r\n        >\r\n          移动\r\n        </loading-action>\r\n      </template>\r\n    </a-modal>\r\n\r\n    <a-modal\r\n      v-if=\"miniWidth\"\r\n      title=\"选择分类\"\r\n      v-model=\"categoriesDialog\"\r\n      :footer=\"null\"\r\n    >\r\n      <category\r\n        class=\"h-100\"\r\n        ref=\"category\"\r\n        @select=\"onCategorySelect\"\r\n        @categories-change=\"onCategoriesChange\"\r\n      />\r\n    </a-modal>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport LzPopconfirm from '@c/LzPopconfirm'\r\nimport {\r\n  batchDestroyMedia,\r\n  batchUpdateMedia,\r\n  getCategoryMedia,\r\n  getMedia,\r\n  storeMedia,\r\n} from '@/api/system-media'\r\nimport _get from 'lodash/get'\r\nimport LzPagination from '@c/LzPagination'\r\nimport {\r\n  debounceMsg,\r\n  getExt,\r\n  getMessage,\r\n  nestedToSelectOptions,\r\n} from '@/libs/utils'\r\nimport _differenceBy from 'lodash/differenceBy'\r\nimport Category from './Category'\r\nimport Files from '@c/SystemMedia/Files'\r\nimport Space from '@c/Space'\r\nimport LoadingAction from '@c/LoadingAction'\r\n\r\nexport default {\r\n  name: 'SystemMedia',\r\n  components: {\r\n    Space,\r\n    Files,\r\n    Category,\r\n    LzPagination,\r\n    LzPopconfirm,\r\n    LoadingAction,\r\n  },\r\n  data() {\r\n    return {\r\n      categories: [],\r\n      currentCategory: null,\r\n\r\n      media: [],\r\n      mediaLoading: false,\r\n      page: null,\r\n\r\n      ext: this.defaultExt || '', // 只做查询筛选，不做强制限制\r\n      extTemp: '', // 弹框中输入时，未确认的值\r\n      extDialog: false,\r\n\r\n      selected: [],\r\n\r\n      movingDialog: false,\r\n      moving: false,\r\n      movingTarget: '',\r\n\r\n      uploading: false,\r\n      uploadCount: 0,\r\n      uploadFail: 0,\r\n      uploadSuccess: 0,\r\n      uploadInvalid: 0,\r\n\r\n      // 作为管理页面使用时，可以切换\r\n      multiple: this.defaultMultiple === undefined\r\n        ? false\r\n        : this.defaultMultiple,\r\n\r\n      categoriesDialog: false,\r\n    }\r\n  },\r\n  props: {\r\n    /**\r\n     * 设置了该值，就不能再手动筛选了，\r\n     * 并强制只能上传和选择这些类型的文件\r\n     */\r\n    defaultExt: {\r\n      type: String,\r\n      default: '',\r\n    },\r\n    /**\r\n     * 多选，同上\r\n     * 作为文件选择器使用时，设置就不能切换了\r\n     */\r\n    defaultMultiple: {\r\n      type: Boolean,\r\n      default: undefined,\r\n    },\r\n  },\r\n  computed: {\r\n    currentCategoryId() {\r\n      return _get(this.currentCategory, 'id', -1)\r\n    },\r\n    miniWidth() {\r\n      return this.$store.state.miniWidth\r\n    },\r\n    tinyWidth() {\r\n      return this.$store.state.tinyWidth\r\n    },\r\n    anySelected() {\r\n      return this.selectedCount > 0\r\n    },\r\n    selectedCount() {\r\n      return this.selected.length\r\n    },\r\n    categoriesSelectOptions() {\r\n      return nestedToSelectOptions(this.categories, {\r\n        title: 'name',\r\n        firstLevel: null,\r\n      })\r\n    },\r\n    uploadingText() {\r\n      return this.uploading\r\n        ? `正在上传中 (${this.uploadSuccess} / ${this.uploadCount})`\r\n        : ''\r\n    },\r\n    getThis() {\r\n      return this\r\n    },\r\n    extArray() {\r\n      return this.ext.split(',')\r\n    },\r\n  },\r\n  async created() {\r\n    await this.getMedia()\r\n  },\r\n  methods: {\r\n    async getMedia(categoryId = -1, page) {\r\n      this.mediaLoading = true\r\n      let data\r\n      const params = {\r\n        page,\r\n        ext: this.ext || undefined,\r\n      }\r\n      try {\r\n        if (categoryId > 0) {\r\n          ({ data } = await getCategoryMedia(categoryId, params))\r\n        } else {\r\n          // -1 为获取所有文件，所以不需要传 category_id 参数，设为 undefined 就行\r\n          params.category_id = (categoryId === -1) ? undefined : 0;\r\n          ({ data } = await getMedia(params))\r\n        }\r\n\r\n        // 如果在请求图片时，切换了分类，则不做处理\r\n        if (this.currentCategoryId !== categoryId) {\r\n          return\r\n        }\r\n\r\n        this.media = data.data\r\n        this.page = data.meta\r\n      } finally {\r\n        this.mediaLoading = false\r\n      }\r\n    },\r\n    onPageChange(page) {\r\n      this.getMedia(this.currentCategoryId, page)\r\n    },\r\n    async onReloadMedia() {\r\n      await this.getMedia(this.currentCategoryId)\r\n    },\r\n    onExtFilter() {\r\n      if (this.defaultExt) {\r\n        return\r\n      }\r\n\r\n      this.ext = this.extTemp\r\n      this.extDialog = false\r\n    },\r\n    /**\r\n     * 清除选中状态\r\n     */\r\n    clearSelected() {\r\n      this.selected = []\r\n    },\r\n    async onMove() {\r\n      if (!this.movingTarget || !this.selectedCount) {\r\n        return\r\n      }\r\n      if (this.movingTarget === this.currentCategoryId) {\r\n        this.$message.info('没有移动到其他分类')\r\n        this.movingDialog = false\r\n        return\r\n      }\r\n\r\n      await this.batchUpdateMedia({\r\n        id: this.selected.map((i) => i.id),\r\n        category_id: this.movingTarget,\r\n      })\r\n    },\r\n    async batchUpdateMedia(data) {\r\n      await batchUpdateMedia(data).setConfig({\r\n        showValidationMsg: true,\r\n      })\r\n      this.movingDialog = false\r\n      this.$message.success(getMessage('updated'))\r\n\r\n      if (this.currentCategoryId === -1) { // 如果是在所有分类下，则只需要清除选中\r\n        this.clearSelected()\r\n      } else { // 否则，要从数据中清除\r\n        this.moveSelected()\r\n      }\r\n    },\r\n    /**\r\n     * 从当前数据中，移除选中的文件\r\n     */\r\n    moveSelected() {\r\n      // 从列表中，去掉已选择的\r\n      this.media = _differenceBy(this.media, this.selected, 'id')\r\n      this.clearSelected()\r\n      if (this.media.length === 0) {\r\n        this.onReloadMedia()\r\n      }\r\n    },\r\n    async onDestroyMedia() {\r\n      if (!this.selectedCount) {\r\n        return\r\n      }\r\n\r\n      await batchDestroyMedia(this.selected.map((i) => i.id))\r\n      this.$message.success(getMessage('destroyed'))\r\n      this.moveSelected()\r\n    },\r\n    onCategorySelect(category) {\r\n      this.currentCategory = category\r\n    },\r\n    onCategoriesChange(categories) {\r\n      this.categories = categories\r\n    },\r\n    async storeMedia({ file, onSuccess, onError }) {\r\n      const id = this.currentCategoryId\r\n\r\n      if (id <= 0) {\r\n        return\r\n      }\r\n      let res\r\n      try {\r\n        res = await storeMedia(id, file).setConfig({ showValidationMsg: true })\r\n        onSuccess(res, null)\r\n        // 如果上传完后，没有切换分类，或者是所有分类\r\n        // 则把数据怼到当前的文件列表前面\r\n        if (id === this.currentCategoryId || this.currentCategoryId === -1) {\r\n          this.media.unshift(res.data)\r\n        }\r\n      } catch (e) {\r\n        onError(e, res)\r\n      }\r\n    },\r\n    onUploadChange({ file }) {\r\n      if (file.status === 'done') { // 上传成功一个\r\n        this.uploadSuccess++\r\n      } else if (file.status === 'error') { // 上传失败一个\r\n        this.uploadFail++\r\n      }\r\n\r\n      // 上传完毕，清除上传列表\r\n      if (\r\n        this.uploadCount &&\r\n        (this.uploadSuccess + this.uploadFail === this.uploadCount)\r\n      ) {\r\n        this.$info({\r\n          title: '上传完成',\r\n          content: `上传成功 (${this.uploadSuccess})，失败 (${this.uploadFail})，无效 (${this.uploadInvalid})`,\r\n        })\r\n\r\n        this.$refs.upload.sFileList = []\r\n        this.uploading = false\r\n        this.uploadCount = 0\r\n        this.uploadFail = 0\r\n        this.uploadSuccess = 0\r\n      }\r\n    },\r\n    beforeUpload(file) {\r\n      const lt10M = file.size / 1024 / 1024 <= 10\r\n      if (!lt10M) {\r\n        // 有时候选择 N 个无效文件，会弹出一串提示，，所以搞个防抖，10ms 延迟\r\n        // 还有其他更好的方法？\r\n        debounceMsg('文件 不能大于 10240 KB')\r\n      }\r\n\r\n      // 如果指定了类型，则只能上传该类型的文件\r\n      const validExt = !this.defaultExt || (this.extArray.indexOf(getExt(file.name)) !== -1)\r\n      if (!validExt) {\r\n        debounceMsg('文件类型只能是：' + this.defaultExt)\r\n      }\r\n\r\n      const res = lt10M && validExt\r\n\r\n      if (res) { // 开始上传一个\r\n        this.uploadCount++\r\n        this.uploading = true\r\n      } else { // 无效文件\r\n        this.uploadInvalid++\r\n      }\r\n\r\n      return res\r\n    },\r\n    onOpenExtDialog() {\r\n      if (this.defaultExt) {\r\n        return\r\n      }\r\n\r\n      this.extDialog = true\r\n    },\r\n  },\r\n  watch: {\r\n    currentCategoryId(newVal) {\r\n      this.clearSelected()\r\n      this.getMedia(newVal)\r\n    },\r\n    extDialog(newVal) {\r\n      if (newVal) {\r\n        this.extTemp = this.ext\r\n      }\r\n    },\r\n    ext(newVal) {\r\n      this.clearSelected()\r\n      this.getMedia(this.currentCategoryId)\r\n    },\r\n    miniWidth(newVal) {\r\n      if (!newVal) {\r\n        this.categoriesDialog = false\r\n      }\r\n    },\r\n    defaultMultiple(newVal) {\r\n      this.multiple = newVal\r\n    },\r\n  },\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n@import \"~@/styles/vars\";\r\n\r\n@padding: 16px;\r\n\r\n.system-media {\r\n  min-width: 0;\r\n  height: 550px;\r\n  display: flex;\r\n  border: @border-base;\r\n  border-radius: @border-radius-base;\r\n}\r\n\r\n.sider {\r\n  width: 220px;\r\n  padding: @padding;\r\n  border-right: @border-base;\r\n}\r\n\r\n.content {\r\n  display: flex;\r\n  flex: 1;\r\n  flex-direction: column;\r\n  min-width: 0;\r\n}\r\n\r\n.header, .footer {\r\n  padding: @padding;\r\n  overflow-x: auto;\r\n  width: 100%;\r\n  min-height: 65px;\r\n}\r\n\r\n.header {\r\n  border-bottom: @border-base;\r\n}\r\n\r\n.footer {\r\n  border-top: @border-base;\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.files {\r\n  flex: 1;\r\n  padding: @padding;\r\n  overflow: auto;\r\n}\r\n\r\n.files-empty {\r\n  ::v-deep {\r\n    .ant-spin-container {\r\n      height: 100%;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n    }\r\n  }\r\n}\r\n\r\n.tiny-width {\r\n  .footer {\r\n    flex-direction: column-reverse;\r\n    align-items: flex-start;\r\n  }\r\n\r\n  ::v-deep {\r\n    .pagination {\r\n      margin-bottom: 8px !important;\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=31f498c1&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=31f498c1&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"31f498c1\",\n  null\n  \n)\n\nexport default component.exports","var baseDifference = require('./_baseDifference'),\n    baseFlatten = require('./_baseFlatten'),\n    baseIteratee = require('./_baseIteratee'),\n    baseRest = require('./_baseRest'),\n    isArrayLikeObject = require('./isArrayLikeObject'),\n    last = require('./last');\n\n/**\n * This method is like `_.difference` except that it accepts `iteratee` which\n * is invoked for each element of `array` and `values` to generate the criterion\n * by which they're compared. The order and references of result values are\n * determined by the first array. The iteratee is invoked with one argument:\n * (value).\n *\n * **Note:** Unlike `_.pullAllBy`, this method returns a new array.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Array\n * @param {Array} array The array to inspect.\n * @param {...Array} [values] The values to exclude.\n * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n * @returns {Array} Returns the new array of filtered values.\n * @example\n *\n * _.differenceBy([2.1, 1.2], [2.3, 3.4], Math.floor);\n * // => [1.2]\n *\n * // The `_.property` iteratee shorthand.\n * _.differenceBy([{ 'x': 2 }, { 'x': 1 }], [{ 'x': 1 }], 'x');\n * // => [{ 'x': 2 }]\n */\nvar differenceBy = baseRest(function(array, values) {\n  var iteratee = last(values);\n  if (isArrayLikeObject(iteratee)) {\n    iteratee = undefined;\n  }\n  return isArrayLikeObject(array)\n    ? baseDifference(array, baseFlatten(values, 1, isArrayLikeObject, true), baseIteratee(iteratee, 2))\n    : [];\n});\n\nmodule.exports = differenceBy;\n","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FilePreview.vue?vue&type=style&index=0&id=1b18567e&scoped=true&lang=less&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FilePreview.vue?vue&type=style&index=0&id=1b18567e&scoped=true&lang=less&\"","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./LzPopconfirm.vue?vue&type=style&index=0&id=279a699e&scoped=true&lang=less&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./LzPopconfirm.vue?vue&type=style&index=0&id=279a699e&scoped=true&lang=less&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.page)?_c('a-pagination',_vm._b({ref:\"page\",staticClass:\"my-1 pagination\",attrs:{\"page-size-options\":_vm.pageSizes,\"total\":_vm.page.total,\"show-size-changer\":_vm.showSizeChanger,\"show-quick-jumper\":_vm.showQuickJumper,\"show-total\":function (total) { return (\"共 \" + total + \" 条\"); },\"page-size\":_vm.perPage},on:{\"update:pageSize\":function($event){_vm.perPage=$event},\"update:page-size\":function($event){_vm.perPage=$event},\"change\":_vm.onChange,\"showSizeChange\":_vm.onSizeChange},model:{value:(_vm.currentPage),callback:function ($$v) {_vm.currentPage=$$v},expression:\"currentPage\"}},'a-pagination',_vm.$attrs,false)):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <a-pagination\r\n    ref=\"page\"\r\n    v-if=\"page\"\r\n    v-model=\"currentPage\"\r\n    v-bind=\"$attrs\"\r\n    :page-size-options=\"pageSizes\"\r\n    class=\"my-1 pagination\"\r\n    :total=\"page.total\"\r\n    :show-size-changer=\"showSizeChanger\"\r\n    :show-quick-jumper=\"showQuickJumper\"\r\n    :show-total=\"total => `共 ${total} 条`\"\r\n    :page-size.sync=\"perPage\"\r\n    @change=\"onChange\"\r\n    @showSizeChange=\"onSizeChange\"\r\n  />\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'LzPagination',\r\n  data() {\r\n    return {\r\n      currentPage: 1,\r\n      perPage: 15,\r\n    }\r\n  },\r\n  props: {\r\n    page: Object,\r\n    /**\r\n     * 分页改变时，是否自动改变地址栏的 query string\r\n     */\r\n    autoPush: {\r\n      type: Boolean,\r\n      default: true,\r\n    },\r\n    showSizeChanger: {\r\n      type: Boolean,\r\n      default: true,\r\n    },\r\n    showQuickJumper: {\r\n      type: Boolean,\r\n      default: true,\r\n    },\r\n  },\r\n  computed: {\r\n    pageSizes() {\r\n      const sizes = ['15', '30', '50', '100', '200']\r\n      const perPage = this.page.per_page.toString()\r\n      if (sizes.indexOf(perPage) === -1) {\r\n        return [perPage, ...sizes]\r\n      } else {\r\n        return sizes\r\n      }\r\n    },\r\n  },\r\n  methods: {\r\n    push({ page, perPage }) {\r\n      const query = Object.assign({}, this.$route.query, {\r\n        page: page || this.currentPage,\r\n        per_page: perPage || this.perPage,\r\n      })\r\n      this.$router.push({\r\n        path: this.$route.path,\r\n        query,\r\n      })\r\n    },\r\n    onSizeChange(current, perPage) {\r\n      this.$emit('size-change', perPage)\r\n      if (!this.autoPush) {\r\n        return\r\n      }\r\n\r\n      // 切换每页数后，当前页置为 1\r\n      this.currentPage = 1\r\n      this.push({ page: 1, perPage })\r\n    },\r\n    onChange(page) {\r\n      this.$emit('current-change', page)\r\n      this.autoPush && this.push({ page })\r\n    },\r\n  },\r\n  watch: {\r\n    page: {\r\n      handler(newVal) {\r\n        if (!newVal) {\r\n          return\r\n        }\r\n        this.currentPage = newVal.current_page\r\n        this.perPage = newVal.per_page\r\n      },\r\n      immediate: true,\r\n    },\r\n  },\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.pagination {\r\n  overflow-x: auto;\r\n  white-space: nowrap;\r\n  height: 40px;\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./LzPagination.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./LzPagination.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./LzPagination.vue?vue&type=template&id=453ab4ed&scoped=true&\"\nimport script from \"./LzPagination.vue?vue&type=script&lang=js&\"\nexport * from \"./LzPagination.vue?vue&type=script&lang=js&\"\nimport style0 from \"./LzPagination.vue?vue&type=style&index=0&id=453ab4ed&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"453ab4ed\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Files.vue?vue&type=style&index=0&id=5b04a1dc&scoped=true&lang=less&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Files.vue?vue&type=style&index=0&id=5b04a1dc&scoped=true&lang=less&\""],"sourceRoot":""}