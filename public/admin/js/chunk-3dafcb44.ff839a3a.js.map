{"version":3,"sources":["webpack:///./src/components/LzForm/FilePicker.vue?5381","webpack:///./src/views/admin-users/Form.vue?d3b5","webpack:///src/views/admin-users/Form.vue","webpack:///./src/views/admin-users/Form.vue?a20e","webpack:///./src/views/admin-users/Form.vue","webpack:///./src/components/LzForm/FilePicker.vue?7ec0","webpack:///src/components/LzForm/FilePicker.vue","webpack:///./src/components/LzForm/FilePicker.vue?ab88","webpack:///./src/components/LzForm/FilePicker.vue","webpack:///./src/components/LzForm/FilePicker.vue?36dd"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","getData","onSubmit","form","errors","on","$event","model","value","callback","$$v","$set","expression","_l","i","key","id","name","_v","_s","staticRenderFns","components","FilePicker","PageContent","LzForm","LzFormItem","data","username","password","password_confirmation","roles","permissions","avatar","methods","component","staticClass","item","stopPropagation","onReplace","remove","directives","rawName","isMax","onPick","pickerIcon","title","dialog","ref","mediaMultiple","ext","scopedSlots","_u","fn","media","anySelected","onPickConfirm","selected","LzPopconfirm","FilePreview","SystemMedia","inject","lzFormItem","default","formattedValue","pickIndex","props","multiple","Boolean","max","type","String","Number","valueFields","flatValue","computed","canPick","isReplace","miniWidth","$store","state","arrayValue","Array","isArray","map","formatReturn","$emit","$refs","clearSelected","fields","length","push","splice","index","watch","newVal"],"mappings":"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","file":"js/chunk-3dafcb44.ff839a3a.js","sourcesContent":["import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FilePicker.vue?vue&type=style&index=0&id=f34a7758&scoped=true&lang=less&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FilePicker.vue?vue&type=style&index=0&id=f34a7758&scoped=true&lang=less&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('page-content',{attrs:{\"center\":\"\"}},[_c('lz-form',{attrs:{\"get-data\":_vm.getData,\"submit\":_vm.onSubmit,\"form\":_vm.form,\"errors\":_vm.errors},on:{\"update:form\":function($event){_vm.form=$event},\"update:errors\":function($event){_vm.errors=$event}}},[_c('lz-form-item',{attrs:{\"label\":\"帐号\",\"required\":\"\",\"prop\":\"username\"}},[_c('a-input',{model:{value:(_vm.form.username),callback:function ($$v) {_vm.$set(_vm.form, \"username\", $$v)},expression:\"form.username\"}})],1),_c('lz-form-item',{attrs:{\"label\":\"姓名\",\"required\":\"\",\"prop\":\"name\"}},[_c('a-input',{model:{value:(_vm.form.name),callback:function ($$v) {_vm.$set(_vm.form, \"name\", $$v)},expression:\"form.name\"}})],1),_c('lz-form-item',{attrs:{\"label\":\"头像\",\"prop\":\"avatar\"}},[_c('file-picker',{attrs:{\"ext\":\"jpg,gif,png,jpeg\"},model:{value:(_vm.form.avatar),callback:function ($$v) {_vm.$set(_vm.form, \"avatar\", $$v)},expression:\"form.avatar\"}})],1),_c('lz-form-item',{attrs:{\"label\":\"密码\",\"required-when-create\":\"\",\"prop\":\"password\"}},[_c('a-input',{attrs:{\"type\":\"password\"},model:{value:(_vm.form.password),callback:function ($$v) {_vm.$set(_vm.form, \"password\", $$v)},expression:\"form.password\"}})],1),_c('lz-form-item',{attrs:{\"label\":\"确认密码\",\"required-when-create\":\"\",\"prop\":\"password_confirmation\"}},[_c('a-input',{attrs:{\"type\":\"password\"},model:{value:(_vm.form.password_confirmation),callback:function ($$v) {_vm.$set(_vm.form, \"password_confirmation\", $$v)},expression:\"form.password_confirmation\"}})],1),_c('lz-form-item',{attrs:{\"label\":\"角色\",\"prop\":\"roles\"}},[_c('a-select',{attrs:{\"mode\":\"multiple\",\"option-filter-prop\":\"name\",\"allow-clear\":\"\"},model:{value:(_vm.form.roles),callback:function ($$v) {_vm.$set(_vm.form, \"roles\", $$v)},expression:\"form.roles\"}},_vm._l((_vm.roles),function(i){return _c('a-select-option',{key:i.id,attrs:{\"name\":i.name}},[_vm._v(\" \"+_vm._s(i.name)+\" \")])}),1)],1),_c('lz-form-item',{attrs:{\"label\":\"权限\",\"prop\":\"permissions\"}},[_c('a-select',{attrs:{\"mode\":\"multiple\",\"option-filter-prop\":\"name\",\"allow-clear\":\"\"},model:{value:(_vm.form.permissions),callback:function ($$v) {_vm.$set(_vm.form, \"permissions\", $$v)},expression:\"form.permissions\"}},_vm._l((_vm.permissions),function(i){return _c('a-select-option',{key:i.id,attrs:{\"name\":i.name}},[_vm._v(\" \"+_vm._s(i.name)+\" \")])}),1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <page-content center>\r\n    <lz-form\r\n      :get-data=\"getData\"\r\n      :submit=\"onSubmit\"\r\n      :form.sync=\"form\"\r\n      :errors.sync=\"errors\"\r\n    >\r\n      <lz-form-item label=\"帐号\" required prop=\"username\">\r\n        <a-input v-model=\"form.username\"/>\r\n      </lz-form-item>\r\n      <lz-form-item label=\"姓名\" required prop=\"name\">\r\n        <a-input v-model=\"form.name\"/>\r\n      </lz-form-item>\r\n      <lz-form-item label=\"头像\" prop=\"avatar\">\r\n        <file-picker v-model=\"form.avatar\" ext=\"jpg,gif,png,jpeg\"/>\r\n      </lz-form-item>\r\n      <lz-form-item label=\"密码\" required-when-create prop=\"password\">\r\n        <a-input v-model=\"form.password\" type=\"password\"/>\r\n      </lz-form-item>\r\n      <lz-form-item label=\"确认密码\" required-when-create prop=\"password_confirmation\">\r\n        <a-input v-model=\"form.password_confirmation\" type=\"password\"/>\r\n      </lz-form-item>\r\n      <lz-form-item label=\"角色\" prop=\"roles\">\r\n        <a-select\r\n          v-model=\"form.roles\"\r\n          mode=\"multiple\"\r\n          option-filter-prop=\"name\"\r\n          allow-clear\r\n        >\r\n          <a-select-option\r\n            v-for=\"i of roles\"\r\n            :key=\"i.id\"\r\n            :name=\"i.name\"\r\n          >\r\n            {{ i.name }}\r\n          </a-select-option>\r\n        </a-select>\r\n      </lz-form-item>\r\n      <lz-form-item label=\"权限\" prop=\"permissions\">\r\n        <a-select\r\n          v-model=\"form.permissions\"\r\n          mode=\"multiple\"\r\n          option-filter-prop=\"name\"\r\n          allow-clear\r\n        >\r\n          <a-select-option\r\n            v-for=\"i of permissions\"\r\n            :key=\"i.id\"\r\n            :name=\"i.name\"\r\n          >\r\n            {{ i.name }}\r\n          </a-select-option>\r\n        </a-select>\r\n      </lz-form-item>\r\n    </lz-form>\r\n  </page-content>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n  createAdminUser,\r\n  editAdminUser,\r\n  storeAdminUser,\r\n  updateAdminUser,\r\n} from '@/api/admin-users'\r\nimport LzForm from '@c/LzForm'\r\nimport LzFormItem from '@c/LzForm/LzFormItem'\r\nimport PageContent from '@c/PageContent'\r\nimport FilePicker from '@c/LzForm/FilePicker'\r\n\r\nexport default {\r\n  name: 'Form',\r\n  components: {\r\n    FilePicker,\r\n    PageContent,\r\n    LzForm,\r\n    LzFormItem,\r\n  },\r\n  data() {\r\n    return {\r\n      form: {\r\n        username: '',\r\n        name: '',\r\n        password: '',\r\n        password_confirmation: '',\r\n        roles: [],\r\n        permissions: [],\r\n        avatar: '',\r\n      },\r\n      errors: {},\r\n      roles: [],\r\n      permissions: [],\r\n    }\r\n  },\r\n  methods: {\r\n    async getData($form) {\r\n      let data\r\n\r\n      if ($form.realEditMode) {\r\n        ({ data } = await editAdminUser($form.resourceId))\r\n      } else {\r\n        ({ data } = await createAdminUser())\r\n      }\r\n\r\n      this.roles = data.roles\r\n      this.permissions = data.permissions\r\n\r\n      return data.data\r\n    },\r\n    async onSubmit($form) {\r\n      if ($form.realEditMode) {\r\n        await updateAdminUser($form.resourceId, this.form)\r\n      } else {\r\n        await storeAdminUser(this.form)\r\n      }\r\n    },\r\n  },\r\n}\r\n</script>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Form.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Form.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Form.vue?vue&type=template&id=8ef11f1a&\"\nimport script from \"./Form.vue?vue&type=script&lang=js&\"\nexport * from \"./Form.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"file-picker\"},[_c('div',{staticClass:\"file-wrapper\"},[_vm._l((_vm.arrayValue),function(item,i){return _c('file-preview',{key:i,staticClass:\"preview file-item\",attrs:{\"file\":item}},[_c('a-icon',{staticClass:\"replace\",attrs:{\"type\":\"sync\",\"title\":\"替换\"},on:{\"click\":function($event){$event.stopPropagation();return _vm.onReplace(i)}}}),_c('lz-popconfirm',{attrs:{\"title\":\"确认移除？\",\"confirm\":function () { return _vm.remove(i); }}},[_c('a-icon',{staticClass:\"remove\",attrs:{\"type\":\"delete\",\"title\":\"移除\"}})],1)],1)}),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(!_vm.isMax),expression:\"!isMax\"}],staticClass:\"picker file-item flex-box\",on:{\"click\":_vm.onPick}},[_c('svg-icon',{staticClass:\"file-icon\",attrs:{\"icon-class\":_vm.pickerIcon}})],1)],2),_c('a-modal',{attrs:{\"title\":_vm.title,\"width\":\"90%\",\"footer\":null,\"wrap-class-name\":\"system-media-dialog\"},model:{value:(_vm.dialog),callback:function ($$v) {_vm.dialog=$$v},expression:\"dialog\"}},[_c('system-media',{ref:\"media\",attrs:{\"default-multiple\":_vm.mediaMultiple,\"default-ext\":_vm.ext},scopedSlots:_vm._u([{key:\"actions\",fn:function(media){return [_c('a-button',{attrs:{\"type\":\"primary\",\"disabled\":!media.anySelected},on:{\"click\":function($event){return _vm.onPickConfirm(media.selected)}}},[_vm._v(\" 选定 \")])]}}])})],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"file-picker\">\r\n    <div class=\"file-wrapper\">\r\n      <file-preview\r\n        class=\"preview file-item\"\r\n        v-for=\"(item, i) of arrayValue\"\r\n        :key=\"i\"\r\n        :file=\"item\"\r\n      >\r\n        <a-icon\r\n          class=\"replace\"\r\n          type=\"sync\"\r\n          title=\"替换\"\r\n          @click.stop=\"onReplace(i)\"\r\n        />\r\n        <lz-popconfirm title=\"确认移除？\" :confirm=\"() => remove(i)\">\r\n          <a-icon\r\n            class=\"remove\"\r\n            type=\"delete\"\r\n            title=\"移除\"\r\n          />\r\n        </lz-popconfirm>\r\n      </file-preview>\r\n\r\n      <div\r\n        v-show=\"!isMax\"\r\n        class=\"picker file-item flex-box\"\r\n        @click=\"onPick\"\r\n      >\r\n        <svg-icon class=\"file-icon\" :icon-class=\"pickerIcon\"/>\r\n      </div>\r\n    </div>\r\n\r\n    <a-modal\r\n      :title=\"title\"\r\n      v-model=\"dialog\"\r\n      width=\"90%\"\r\n      :footer=\"null\"\r\n      wrap-class-name=\"system-media-dialog\"\r\n    >\r\n      <system-media\r\n        ref=\"media\"\r\n        :default-multiple=\"mediaMultiple\"\r\n        :default-ext=\"ext\"\r\n      >\r\n        <template #actions=\"media\">\r\n          <a-button\r\n            type=\"primary\"\r\n            :disabled=\"!media.anySelected\"\r\n            @click=\"onPickConfirm(media.selected)\"\r\n          >\r\n            选定\r\n          </a-button>\r\n        </template>\r\n      </system-media>\r\n    </a-modal>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport SystemMedia from '@c/SystemMedia/index'\r\nimport FilePreview from '@c/FilePreview'\r\nimport _pick from 'lodash/pick'\r\nimport LzPopconfirm from '@c/LzPopconfirm'\r\n\r\nexport default {\r\n  name: 'FilePicker',\r\n  components: {\r\n    LzPopconfirm,\r\n    FilePreview,\r\n    SystemMedia,\r\n  },\r\n  inject: {\r\n    lzFormItem: {\r\n      default: null,\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      dialog: false,\r\n      formattedValue: null,\r\n      pickIndex: -1,\r\n    }\r\n  },\r\n  props: {\r\n    /**\r\n     * 多选\r\n     */\r\n    multiple: Boolean,\r\n    /**\r\n     * 最多选多少个\r\n     */\r\n    max: {\r\n      type: [String, Number],\r\n      default: 8,\r\n    },\r\n    /**\r\n     * 选择器弹框的标题，默认为 FormItem 的 label 属性\r\n     */\r\n    title: {\r\n      type: String,\r\n      default() {\r\n        return this.lzFormItem?.label || '选择文件'\r\n      },\r\n    },\r\n    value: null,\r\n    /**\r\n     * 类型筛选，强制限制上传和选择\r\n     */\r\n    ext: String,\r\n    /**\r\n     * 返回的数据对象中，只包含指定字段，path 字段会自动包含\r\n     * 不传则包含所有字段\r\n     */\r\n    valueFields: {\r\n      type: String,\r\n      default: 'path',\r\n    },\r\n    /**\r\n     * 在 valueFields 只返回一个字段时，是否直接返回该字段值，而非对象\r\n     */\r\n    flatValue: {\r\n      type: Boolean,\r\n      default: true,\r\n    },\r\n  },\r\n  computed: {\r\n    pickerIcon() {\r\n      return this.multiple ? 'multi-file' : 'single-file'\r\n    },\r\n    canPick() {\r\n      // 没有达到最大可选数，或者是替换文件的情况下，可以打开文件选择器\r\n      return !this.isMax || this.isReplace\r\n    },\r\n    isMax() {\r\n      return (this.multiple && this.value.length >= this.max) ||\r\n        (!this.multiple && this.value)\r\n    },\r\n    /**\r\n     * 是否是处于替换文件的情况\r\n     */\r\n    isReplace() {\r\n      return this.pickIndex !== -1\r\n    },\r\n    miniWidth() {\r\n      return this.$store.state.miniWidth\r\n    },\r\n    arrayValue() {\r\n      if (!this.value) {\r\n        return []\r\n      }\r\n\r\n      return Array.isArray(this.value) ? this.value : [this.value]\r\n    },\r\n    mediaMultiple() {\r\n      // 替换的情况下，只能单选\r\n      return this.isReplace ? false : this.multiple\r\n    },\r\n  },\r\n  methods: {\r\n    onPick() {\r\n      if (!this.canPick) {\r\n        return\r\n      }\r\n\r\n      this.dialog = true\r\n    },\r\n    onPickConfirm(selected) {\r\n      selected = selected.map(this.formatReturn)\r\n      let value\r\n      // 复制并格式化 selected 中的对象的值\r\n      if (this.multiple) {\r\n        if (this.isReplace) {\r\n          value = this.value\r\n          value[this.pickIndex] = selected[0]\r\n        } else {\r\n          value = this\r\n            .value\r\n            .concat(selected.slice(0, this.max - this.value.length))\r\n        }\r\n      } else {\r\n        value = selected[0]\r\n      }\r\n\r\n      this.$emit('input', value)\r\n      this.$refs.media.clearSelected()\r\n      this.dialog = false\r\n    },\r\n    /**\r\n     * 根据 valueFields 和 flatValue 格式化返回值\r\n     */\r\n    formatReturn(value) {\r\n      let fields = this.valueFields ? this.valueFields.split(',') : []\r\n      if (fields.length === 0) { // 返回字段为空，返回所有字段\r\n        value = { ...value }\r\n      } else { // 否则返回指定字段\r\n        // 默认自动包含 path 字段\r\n        fields.push('path')\r\n        value = _pick(value, fields)\r\n      }\r\n\r\n      // 去重\r\n      fields = [...new Set(fields)]\r\n      // 在只有一个字段时，如果需要平铺，则只返回该字段的值\r\n      if (this.flatValue && fields.length === 1) {\r\n        return value[fields[0]]\r\n      } else {\r\n        return value\r\n      }\r\n    },\r\n    remove(index) {\r\n      if (this.multiple) {\r\n        this.value.splice(index, 1)\r\n      } else {\r\n        this.$emit('input', null)\r\n      }\r\n    },\r\n    onReplace(index) {\r\n      this.pickIndex = index\r\n      this.onPick()\r\n    },\r\n  },\r\n  watch: {\r\n    dialog(newVal) {\r\n      if (!newVal) {\r\n        this.pickIndex = -1\r\n      }\r\n    },\r\n  },\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n@import \"~@/styles/vars\";\r\n\r\n.file-wrapper {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n}\r\n\r\n.picker {\r\n  cursor: pointer;\r\n}\r\n\r\n.file-item {\r\n  width: 100px;\r\n  height: 100px;\r\n  min-width: 100px;\r\n  min-height: 100px;\r\n  border: @border-base;\r\n  border-radius: @border-radius-base;\r\n  color: @border-color-base;\r\n  margin: 0 5px 5px 0;\r\n  transition: all .3s;\r\n\r\n  &:hover {\r\n    border-color: @input-hover-border-color;\r\n    color: @info-color;\r\n  }\r\n\r\n  .file-icon {\r\n    width: 50px;\r\n    height: 50px;\r\n  }\r\n}\r\n\r\n.remove {\r\n  color: @error-color;\r\n}\r\n\r\n.replace {\r\n  color: @primary-color;\r\n}\r\n</style>\r\n\r\n<style lang=\"less\">\r\n.system-media-dialog {\r\n  .ant-modal {\r\n    max-width: 848px;\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FilePicker.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FilePicker.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./FilePicker.vue?vue&type=template&id=f34a7758&scoped=true&\"\nimport script from \"./FilePicker.vue?vue&type=script&lang=js&\"\nexport * from \"./FilePicker.vue?vue&type=script&lang=js&\"\nimport style0 from \"./FilePicker.vue?vue&type=style&index=0&id=f34a7758&scoped=true&lang=less&\"\nimport style1 from \"./FilePicker.vue?vue&type=style&index=1&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"f34a7758\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FilePicker.vue?vue&type=style&index=1&lang=less&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FilePicker.vue?vue&type=style&index=1&lang=less&\""],"sourceRoot":""}